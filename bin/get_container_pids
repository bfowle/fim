#!/bin/bash

if [ "$1" = "" ]; then
  echo "Usage: $0 <pod label selector>"
  exit
fi

containers=($(kubectl get pods \
  --all-namespaces \
  -l $1 \
  -o jsonpath="{.items[*].status.containerStatuses[*].containerID}"))

for c in ${containers[@]}; do
  docker inspect -f "{{.State.Pid}}" $(echo $c | awk -F/ '{print $3}')
done
